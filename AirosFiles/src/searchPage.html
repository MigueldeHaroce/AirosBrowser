<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Electron Tabs Example</title>
  <link rel="stylesheet" href="searchPage3.css" />
</head>
  <body>
    <div class="top-bar">
      <h1></h1>
      <style>
      </style>
      <div class="icons">
      <div class="icon-container">
          <button id="minimizeBtn" class="icon-btn" aria-label="Minimize">
          <img src="icons/minus.svg" id="imgMinimize">
          <style>
              #imgMinimize {
                  padding: 18px;
              }
          </style>
          </button>
      </div>
      <div class="icon-container">
          <button id="restoreBtn" class="icon-btn" aria-label="Restore">
          <img src="icons/restore.svg" id="imgRestore">
          <style>
              #imgRestore {
                  padding: 18px;
              }
          </style>
          </button>
      </div>
      <div class="icon-container">
          <button id="closeBtn" class="icon-btn" aria-label="Close">
          <img src="icons/x.svg" id="imgClose">
          <style>
              #imgClose {
                  padding: 18px;
              }
          </style>
          </button>
          </div>
      </div>
    </div>  
      
    <tab-group new-tab-button="true" sortable="true">
      <style>
        :host {
          --tab-border-color: transparent;
          --button-hover-background: #444;
          --tab-color: #ddd;
          --tab-active-color: #ddd;
          --tab-active-background: #ddd;
          --tag-hover-color: #ddd;
          --button-font-size: 20px;
          --button-border-radius: 50%;
        }

        .tab-title {
          width: 50px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .tab.visible {
          background-color: #202020;
        }
        .tab.active {
          color: var(--tab-color);
          background-color: #444;
        }
        .tab:not(.active):hover {
          color: var(--tab-color);
          background-color: #333;
        }
        .tab-close button {
          color: var(--tab-color);
        }
        .nav {
          background-color: transparent;
        }

        .etabs {
          background-color: transparent;
        }

        .buttons {
          padding: 1px;
        }
        .buttons button:hover {
          padding: 1px;
        }

        .views {
          position: fixed;
          height: calc(100vh - 33px);
          top: 45px;
          width: 100%;
          left: 0px;
        }
      </style>
    </tab-group>

    <script src="electron-tabs/dist/electron-tabs.js"></script>
    <script>
      const tabGroup = document.querySelector("tab-group");
    
      tabGroup.on('tab-added', (tab) => {
        const webview = tab.webview;
    
        // Set tab title based on web page title
        webview.addEventListener('page-title-updated', () => {
          const tabTitle = webview.getTitle();
          tab.setTitle(`<img class="tab-logo" src=""/>${tabTitle}`);
        });
    
        // Set tab logo based on favicon
        webview.addEventListener('dom-ready', async () => {
          let faviconURL;
          const webviewURL = webview.getURL();

          if (webviewURL.includes('google.com')) {
            // Use a fallback favicon URL for google.com
            faviconURL = 'https://www.google.com/favicon.ico';
          } else {
            faviconURL = await getFaviconURL(webviewURL);
          }

          if (faviconURL) {
            console.log(faviconURL);
            tab.setIcon(faviconURL);
          }
        });
      });
    
      const getFaviconURL = async (url) => {
        try {
          const response = await fetch(url);
          const html = await response.text();
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const faviconLink = doc.querySelector('link[rel="icon"]');
          if (faviconLink) {
            const faviconURL = new URL(faviconLink.href, url).href;
            return faviconURL;
          }
        } catch (error) {
          console.error('Error fetching favicon:', error);
        }
        return null;
      };
    
      tabGroup.addTab({
        title: 'Tab 1',
        src: 'https://github.com/',
      });
    
      tabGroup.addTab({
        title: 'Tab 2',
        src: 'https://www.youtube.com/',
      });

      tabGroup.addTab({
        title: 'Tab 3',
        src: 'https://www.google.com/',
      });
    </script>
    
    
    
    <script src="appFunctions.js" defer type="module"></script>
    <script src="renderer.js" defer type="module"></script>  
  </body>
</html>