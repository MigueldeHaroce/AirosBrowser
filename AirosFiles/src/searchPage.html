<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Electron Tabs Example</title>
  <link rel="stylesheet" href="searchPage3.css" />
</head>
  <body>
    <div class="top-bar">
      <h1></h1>
      <style>
      </style>
      <div class="icons">
      <div class="icon-container">
          <button id="minimizeBtn" class="icon-btn" aria-label="Minimize">
          <img src="icons/minus.svg" id="imgMinimize">
          <style>
              #imgMinimize {
                  padding: 18px;
              }
          </style>
          </button>
      </div>
      <div class="icon-container">
          <button id="restoreBtn" class="icon-btn" aria-label="Restore">
          <img src="icons/restore.svg" id="imgRestore">
          <style>
              #imgRestore {
                  padding: 18px;
              }
          </style>
          </button>
      </div>
      <div class="icon-container">
          <button id="closeBtn" class="icon-btn" aria-label="Close">
          <img src="icons/x.svg" id="imgClose">
          <style>
              #imgClose {
                  padding: 18px;
              }
          </style>
          </button>
          </div>
      </div>
    </div>  
      
    <tab-group new-tab-button="true" sortable="true">
      <style>
        :host {
          --tab-border-color: transparent;
          --button-hover-background: #444;
          --tab-color: #ddd;
          --tab-active-color: #ddd;
          --tab-active-background: #ddd;
          --tag-hover-color: #ddd;
          --button-font-size: 20px;
          --button-border-radius: 50%;
        }

        .tab.visible {
          background-color: #202020;
        }
        .tab.active {
          color: var(--tab-color);
          background-color: #444;
        }
        .tab:not(.active):hover {
          color: var(--tab-color);
          background-color: #333;
        }
        .tab-close button {
          color: var(--tab-color);
        }
        .nav {
          background-color: transparent;
        }

        .etabs {
          background-color: transparent;
        }

        .buttons {
          padding: 1px;
        }
        .buttons button:hover {
          padding: 1px;
        }

        .views {
          position: fixed;
          height: calc(100vh - 33px);
          top: 45px;
          width: 100%;
          left: 0px;
        }
      </style>
    </tab-group>

    <script src="electron-tabs/dist/electron-tabs.js"></script>
    <script>
      const tabGroup = document.querySelector("tab-group");

      tabGroup.on('tab-added', (tab) => {
        const webview = tab.webview;

        // Set tab title based on web page title
        webview.addEventListener('page-title-updated', () => {
          const tabTitle = webview.getTitle();
          tab.setTitle(`<img class="tab-logo" src=""/>${tabTitle}`);
        });

        // Set tab logo based on favicon
        webview.addEventListener('dom-ready', () => {
          const tabLogo = webview.getTitle();
          console.log(tabLogo);
          if (tabLogo) {
            const faviconURL = webview.getURL() + '/favicon.ico';
            console.log(faviconURL);
            tab.setIcon(faviconURL);
          }
        });
      });
      
      tabGroup.addTab({
        title: 'Tab 1',
        src: 'https://google.com/',
      });

      tabGroup.addTab({
        title: 'Tab 2',
        src: 'https://www.youtube.com/?gl=ES',
      });

      async function getFavicon(url) {
        try {
          const response = await fetch(`${url}/favicon.ico`);
          if (response.ok) {
            const blob = await response.blob();
            return URL.createObjectURL(blob);
          }
        } catch (error) {
          console.error('Failed to fetch favicon:', error);
        }
        return '';
      }
    </script>
    
    <script src="appFunctions.js" defer type="module"></script>
    <script src="renderer.js" defer type="module"></script>  
  </body>
</html>